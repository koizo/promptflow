name: ocr_analysis
inputs:
  - name: image_file
    type: pdf_or_image
    required: true
    description: "Image or PDF file to extract text from"
  - name: analysis_type
    type: text
    required: false
    description: "Type of analysis to perform (summary, extraction, classification)"
  - name: ocr_provider
    type: text
    required: false
    description: "OCR provider to use (huggingface, tesseract)"
  - name: ocr_model
    type: text
    required: false
    description: "OCR model to use (microsoft/trocr-base-printed, microsoft/trocr-large-printed, etc.)"
  - name: languages
    type: text
    required: false
    description: "Comma-separated list of languages (en, fr, de, etc.)"

steps:
  - type: ocr
    provider: "{ocr_provider}"
    model: "{ocr_model}"
    languages: "{languages}"
    return_bboxes: true
    return_confidence: true
    include_blocks: false
    input: image_file
    output_key: ocr_result
  
  - type: combine
    template: |
      Extracted Text from Image:
      {ocr_result}
      
      Analysis Type: {analysis_type}
      OCR Confidence: {ocr_confidence}
      Processing Details: Extracted using {ocr_provider} model {ocr_model} with {text_blocks_count} text blocks
    output_key: combined_analysis_input
  
  - type: llm
    model: mistral
    provider: ollama
    temperature: 0.3
    prompt_file: analysis_prompt.txt
    input: combined_analysis_input
    output_key: analysis_result

output:
  key: analysis_result
  format: json
